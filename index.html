<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <title>八方雲集訂單系統</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    body {
      font-family: "Microsoft JhengHei", sans-serif;
      margin: 0;
      padding: 1em;
      background: #f9f9f9;
    }
    .section {
      background: #fff;
      padding: 1.5em;
      border-radius: 10px;
      box-shadow: 0 2px 12px rgba(0,0,0,0.1);
      max-width: 800px;
      margin: 30px auto;
    }
    h2 {
      text-align: center;
      color: #b22222;
      margin-bottom: 1em;
    }
    label {
      display: block;
      margin: 1em 0 0.5em;
    }
    select, input {
      font-size: 16px;
      padding: 6px 10px;
      width: 100%;
      box-sizing: border-box;
    }
    button {
      font-size: 16px;
      margin-top: 1em;
      padding: 8px 16px;
      background-color: #d9534f;
      color: white;
      border: none;
      border-radius: 4px;
      cursor: pointer;
    }
    button:hover {
      background-color: #c9302c;
    }
    #orderTable {
      margin-top: 2em;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      background: #fff;
    }
    th, td {
      border: 1px solid #ccc;
      padding: 8px;
      text-align: center;
    }
    th {
      background: #f0f0f0;
    }
    .footer {
      text-align: center;
      font-size: 18px;
      margin-top: 40px;
      line-height: 1.6;
      display: none;
    }
    @media print {
      body * {
        visibility: hidden;
      }
      #orderTable, #orderTable * {
        visibility: visible;
      }
      #orderTable {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
      }
      .footer {
        visibility: visible;
        position: absolute;
        bottom: 0;
        left: 0;
        width: 100%;
      }
    }
  </style>
</head>
<body>
  <div class="section">
    <h2>八方雲集點餐系統</h2>
    <label for="itemSelect">選擇品項：</label>
    <select id="itemSelect">
      <option value="">請選擇</option>
    </select>

    <label for="itemQty">數量（份/顆）：</label>
    <input type="number" id="itemQty" min="1" value="1" />

    <button onclick="addItem()">加入訂單</button>
    <button onclick="clearOrders()">清除所有訂單</button>

    <div id="orderTable"></div>
  </div>

  <div class="footer">
    <div>大瑞科技</div>
    <div>地址: 高雄市大寮區鳳林二路532號</div>
    <div>電話: (07)7871875</div>
  </div>

  <script>
    const menu = {
      "招牌鍋貼(1粒)": 7, "韭菜鍋貼(1粒)": 7, "韓式辣味鍋貼(1粒)": 7,
      "咖哩雞肉鍋貼(1粒)": 7, "玉米鍋貼(1粒)": 7, "新疏食鍋貼(1粒)": 7.5,
      "招牌水餃(1粒)": 7, "韭菜水餃(1粒)": 7, "韓式辣味水餃(1粒)": 7,
      "咖哩雞肉水餃(1粒)": 7, "玉米水餃(1粒)": 7, "新疏食水餃(1粒)": 7.5,
      "鮮蝦水餃(1粒)": 10.5, "滷蛋": 15, "香濃豆漿(有糖/無糖)": 20,
      "黑豆漿": 20, "真傳特調紅茶(470cc)": 20, "黃金泡菜": 30, "酸辣湯": 35,
      "旗魚花枝丸湯": 35, "玉米濃湯": 35, "蘿蔔排骨湯": 35,
      "黃金豆腐": 35, "燙青菜": 35, "燉蘿蔔": 35, "和風秋葵": 35,
      "薄鹽毛豆": 35, "家常小菜": 40, "柚香蘿蔔": 40, "古早味湯麵": 45,
      "古早味乾麵": 45, "寒天真傳紅茶": 45, "皮蛋豆腐": 45,
      "珍珠餛飩湯": 50, "招牌乾麵(微辣)": 55, "麻醬乾麵": 55,
      "菜肉大餛飩湯": 60, "紹辣乾麵": 60,
      "珍珠抄手(小顆8粒) 紅油": 60, "珍珠抄手(小顆8粒) 和風": 60,
      "酸辣湯面": 70, "珍珠餛飩麵": 70,
      "菜肉大抄手(大顆6粒) 紅油": 75, "菜肉大抄手(大顆6粒) 和風": 75,
      "榨菜肉絲麵": 80, "菜肉大餛飩麵": 80, "紹辣珍珠餛飩麵": 80,
      "酸辣湯餃(8顆招牌水餃)": 90, "玉米湯餃(8顆招牌水餃)": 90,
      "紹辣菜肉大餛飩麵": 90, "紅燒牛湯餃(8顆招牌水餃)": 120,
      "紅燒牛湯珍珠餛飩(小顆10顆)": 125, "紅燒牛湯菜肉大餛飩(大顆6顆)": 125,
      "紅燒牛肉麵": 168, "清燉牛肉麵": 168, "麻辣牛肉麵": 178
    };

    const orders = {};

    window.onload = () => {
      const sel = document.getElementById("itemSelect");
      for (let item in menu) {
        sel.innerHTML += `<option value="${item}">${item}（$${menu[item]}）</option>`;
      }
      renderTable();
    };

    function addItem() {
      const item = document.getElementById("itemSelect").value;
      const qty = parseInt(document.getElementById("itemQty").value);
      if (!item || qty <= 0 || isNaN(qty)) return;

      if (!orders[item]) orders[item] = [];
      orders[item].push(qty);
      renderTable();
    }

    function deleteItem(item, index) {
      orders[item].splice(index, 1);
      if (orders[item].length === 0) delete orders[item];
      renderTable();
    }

    function clearOrders() {
      if (confirm("確定要清除所有訂單嗎？")) {
        for (let key in orders) delete orders[key];
        renderTable();
      }
    }

    function renderTable() {
      if (Object.keys(orders).length === 0) {
        document.getElementById("orderTable").innerHTML = "<p>尚無訂單。</p>";
        return;
      }

      let html = "<table><tr><th>品項</th><th>明細</th><th>單價</th><th>小計</th></tr>";
      let total = 0;

      for (let item in orders) {
        const unitPrice = menu[item];
        const unit = item.includes("(1粒)") ? "顆" : "份";

        const rows = orders[item].map((qty, idx) => {
          const subtotal = qty * unitPrice;
          total += subtotal;
          return `<div>${qty} ${unit} - $${subtotal.toFixed(1)} <button onclick="deleteItem('${item}', ${idx})">🗑️</button></div>`;
        }).join("");

        const itemTotal = orders[item].reduce((sum, q) => sum + q * unitPrice, 0);
        html += `<tr>
          <td>${item}</td>
          <td>${rows}</td>
          <td>$${unitPrice}</td>
          <td>$${itemTotal.toFixed(1)}</td>
        </tr>`;
      }

      html += `<tr><td colspan="3"><strong>總金額</strong></td><td><strong>$${total.toFixed(1)}</strong></td></tr></table>`;
      html += `<button onclick="window.print()">列印統計表</button>`;
      document.getElementById("orderTable").innerHTML = html;
    }
  </script>
</body>
</html>
