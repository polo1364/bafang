<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <title>八方雲集點餐統計 - 大瑞科技</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    body { font-family: "Microsoft JhengHei", sans-serif; margin: 0; padding: 20px; background: #f9f9f9; }
    h2 { color: #b30000; text-align: center; }
    table { border-collapse: collapse; width: 100%; margin-top: 20px; background: #fff; }
    th, td { border: 1px solid #ccc; padding: 6px 10px; text-align: center; }
    th { background: #eee; }
    .footer { margin-top: 40px; text-align: center; font-size: 16px; }
    .btn { margin-top: 20px; padding: 8px 14px; }
    @media print {
      .btn, .input-section { display: none !important; }
    }
  </style>
</head>
<body>
  <h2>八方雲集點餐統計（大瑞科技）</h2>

  <div class="input-section">
    <textarea id="inputData" rows="6" style="width:100%;" placeholder="格式如：&#10;韭菜鍋貼：10顆 7顆&#10;招牌鍋貼：8顆"></textarea>
    <br>
    <button class="btn" onclick="generateTable()">產生統計表</button>
    <button class="btn" onclick="window.print()">列印</button>
  </div>

  <div id="result"></div>

  <div class="footer">
    <div>大瑞科技</div>
    <div>地址：高雄市大寮區鳳林二路532號</div>
    <div>電話：(07)7871875</div>
  </div>

<script>
const unitPrice = {
  "招牌鍋貼": 7,
  "韭菜鍋貼": 7,
  "韓式辣味鍋貼": 7,
  "咖哩雞肉鍋貼": 7,
  "玉米鍋貼": 7,
  "新疏食鍋貼": 7.5
};

function generateTable() {
  const input = document.getElementById("inputData").value.trim();
  if (!input) return;

  const lines = input.split("\n");
  let resultHTML = "<table><tr><th>品項</th><th>顆數明細</th><th>總顆數</th><th>單價</th><th>總金額</th></tr>";
  let grandTotal = 0;

  for (let line of lines) {
    const [nameRaw, valuesRaw] = line.split("：");
    if (!nameRaw || !valuesRaw) continue;

    const name = nameRaw.trim();
    const values = valuesRaw.match(/\d+/g)?.map(n => parseInt(n)) || [];
    if (values.length === 0) continue;

    const unit = unitPrice[name] ?? 0;
    const totalQty = values.reduce((a, b) => a + b, 0);
    const subtotal = totalQty * unit;
    grandTotal += subtotal;

    resultHTML += `<tr>
      <td>${name}</td>
      <td>${values.join("、")} 顆</td>
      <td>${totalQty}</td>
      <td>$${unit}</td>
      <td>$${subtotal}</td>
    </tr>`;
  }

  resultHTML += `<tr><td colspan="4"><b>總金額</b></td><td><b>$${grandTotal}</b></td></tr></table>`;
  document.getElementById("result").innerHTML = resultHTML;
}
</script>
</body>
</html>
